<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Accommodations</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="navbar.css">
<link rel="stylesheet" href="accommodation.css">
<link rel="stylesheet" href="webDesign.css">
</head>
<body>

<div class="topnav">
  <a href="index.html">Home</a>
  <a class="active" href="Accomodations.html">Accomodations</a>
  <a href="About us.html">About us</a>
  <a href="signup.html">Sign up</a>
  <div class="search-container">
    <form action="/action_page.php">
      <input type="text" placeholder="Search.." name="search">
      <button type="submit" title="Submit"><i class="fa fa-search"></i></button>
    </form>
  </div>
</div>

<div id="accommodation-constainer">
  <h1>Accommodations available:</h1>
  <ol id="accommodation-list">
    <li class="loading">Loading...</li>
  </ol>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
        var accommodationList = document.querySelector("#accommodation-list");

        var xhr = new XMLHttpRequest();
        // Control click link below and allow access to temporary server
        xhr.open("GET", "https://cors-anywhere.herokuapp.com/https://www.mmu.ac.uk/study/accommodation/our-halls", true);
        xhr.responseType = "document";

        xhr.onload = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
                var response = xhr.responseXML;

                if (!response) {
                    accommodationList.innerHTML = "<li class='loading'>Failed to load data.</li>";
                    return;
                }

                var accommodationItems = response.querySelectorAll("#university-accommodation ol li");

                if (accommodationItems.length === 0) {
                    accommodationList.innerHTML = "<li class='loading'>No accommodation data found.</li>";
                    return;
                }

                // Clear loading text
                accommodationList.innerHTML = "";

                // Populate the list
                accommodationItems.forEach(item => {
                    var li = document.createElement("li");
                    li.textContent = item.textContent.trim(); // Main item

                    // Create a nested list
                    var nestedList = document.createElement("ul");
                    nestedList.classList.add("nested-list");

                    // Example details (Modify this based on real structure)
                    var facilities = ["WiFi", "Laundry", "24/7 Security", "Study Areas"];
                    facilities.forEach(facility => {
                        var nestedLi = document.createElement("li");
                        nestedLi.textContent = facility;
                        nestedList.appendChild(nestedLi);
                    });

                    li.appendChild(nestedList);
                    accommodationList.appendChild(li);
                });

                console.log("Accommodations loaded successfully.");
            }
        };

        xhr.onerror = function () {
            accommodationList.innerHTML = "<li class='loading'>Error loading accommodations. Try again later.</li>";
            console.error("Request failed with status:", xhr.status, xhr.statusText);
        };

        xhr.send();
    });
</script>
</div>

</div>

</body>
</html>
